---
title: "ライツアウトパズルと<br/>連立方程式"
author: 貞廣泰造（津田塾大学)
date: "2020-08-16"
output:
  revealjs::revealjs_presentation:
    self_contained: false
    pandoc_args: [
      '--from', 'markdown-auto_identifiers'
      ]
    reveal_plugins: ["chalkboard","notes"]
    theme: beige
    center: true
---

<style type="text/css">
  .reveal p {
    text-align: left;
  }
  .reveal ul {
    display: block;
	list-style-type: none;
  }
  .reveal ol {
    display: block;
  }
  .reveal section img { background:none; border:none; box-shadow:none; }
</style>
<style type="text/css">
.reveal blockquote { width: 100% }
.reveal p { text-align: left; line-height: 1.6;}
.reveal ul { text-align: left; line-height: 1.6;}
.reveal .org-ul {line-height: 1.4;}
</style>



# ライツアウトパズル

## ルール

>- タイルがライトになっている。
>- クリックされたタイルとその隣接タイルのon-offが反転
>- 全部offにしたら完成

<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script><div alighn="center"><div id="lightsout"></div></div><script src="lightsout.js"></script>
https://opencampussadahiro20.web.app/

## 一般化

どのようなタイル張り(グラフ)の上にも定義できる。

<a href="https://pro4-12b05.firebaseapp.com/"> https://pro4-12b05.firebaseapp.com/ </a>

# 解法と連立方程式

## 有限体${\mathbb F}_2=\{\bar{0},\bar{1}\}$

>- 足し算　（通常の足し算を$2$で割ったあまり）
<table border="1">
<tr>
<td>$+$</td>
<td>$\bar{0}$</td>
<td>$\bar{1}$</td>
</tr>
<tr>
<td>$\bar{0}$</td>
<td>$\bar{0}$</td>
<td>$\bar{1}$</td>
</tr>
<tr>
<td>$\bar{1}$</td>
<td>$\bar{1}$</td>
<td>${\color{red}{\bar{0}}}$</td>
</tr>
</table>
<br/>
$$
\bar{0} + \bar{1} = \bar{1},~~~ \bar{1} + \bar{1} = \bar{0}
$$

<br/>

>- かけ算
<table border="1">
<tr>
<td>$\times$</td>
<td>$\bar{0}$</td>
<td>$\bar{1}$</td>
</tr>
<tr>
<td>$\bar{0}$</td>
<td>$\bar{0}$</td>
<td>$\bar{0}$</td>
</tr>
<tr>
<td>$\bar{1}$</td>
<td>$\bar{0}$</td>
<td>$\bar{1}$</td>
</tr>
</table>

## 基本的な性質

>-
$a + b = b + a,~~~$
$a\times b = b\times a~~$　 (交換法則)

>-
$a + (b + c) = (a + b ) + c~~$　 (結合法則)

>-
$a \times (b \times c) = (a \times b ) \times c$

>-
$a\times(b + c) = a\times b + a\times c~~$　 (分配法則)

## ベクトル

$n$次元ベクトル
$$
\overrightarrow{a}=\begin{pmatrix}a_1\\a_2\\\vdots\\a_n\end{pmatrix}
$$
$\{\bar{0},\bar{1}\}$の元を$n$個並べたもの


## ベクトルの足し算

$$
\overrightarrow{a}=\begin{pmatrix}a_1\\a_2\\\vdots\\a_n\end{pmatrix},
~~
\overrightarrow{b}=\begin{pmatrix}b_1\\b_2\\\vdots\\b_n\end{pmatrix}
$$

$$
\overrightarrow{a} + \overrightarrow{b}
=
\begin{pmatrix}a_1\\a_2\\\vdots\\a_n\end{pmatrix}+\begin{pmatrix}b_1\\b_2\\\vdots\\b_n\end{pmatrix}
=\begin{pmatrix}a_1 + b_1\\a_2 + b_2\\\vdots\\a_n + b_n\end{pmatrix}
$$

## ベクトルのスカラー倍

$$
c \in \{\bar{0},\bar{1}\},~~ \overrightarrow{a}=\begin{pmatrix}a_1\\a_2\\\vdots\\a_n\end{pmatrix},
$$
$$
c\overrightarrow{a} = c\begin{pmatrix}a_1\\a_2\\\vdots\\a_n\end{pmatrix}
=\begin{pmatrix}ca_1\\ca_2\\\vdots\\ca_n\end{pmatrix}
$$


## 1次方程式

>-
$x + \bar{1} = \bar{1}$

>-
$~~~~~~~~~~~\Longrightarrow (x + \bar{1}) + \bar{1} = \bar{1} + \bar{1}$ (両辺に$\bar{1}$を加えた)

>-
$~~~~~~~~~~~\Longrightarrow x + (\bar{1} + \bar{1}) =  \bar{0}$ (結合法則)

>-
$~~~~~~~~~~~\Longrightarrow x + \bar{0} =  \bar{0}$

>-
$~~~~~~~~~~~\Longrightarrow x = \bar{0}$

>-
問: 
方程式　$x + \bar{1} = \bar{0}$　を解け


## 2元連立方程式

>-
$\left\{
\begin{array}{cccc}
x & + & y & = & \bar{1}\\
 & & y & = &  \bar{1}
\end{array}
\right.$

>-
$~~~~~~~~~~~\Longrightarrow x = \bar{0},~~ y = \bar{1}$<br/><br/>

>-
$x\begin{pmatrix}\bar{1}\\\bar{0}\end{pmatrix}+y\begin{pmatrix}\bar{1}\\\bar{1}\end{pmatrix}=\begin{pmatrix}\bar{1}\\\bar{1}\end{pmatrix}~~~~$
 ベクトルによる表現

## ${\mathbb F}_2$によるon-offの表現

$\bar{1}:$ ライトがオン <svg width="40" height="40"><rect x="0" y="0" width="40" height="40" fill="yellow" fill-opacity="0.5" stroke="black"/></svg>

$\bar{0}:$ ライトがオフ <svg width="40" height="40"><rect x="0" y="0" width="40" height="40" fill="gray" fill-opacity="0.5" stroke="black"/></svg>

<br/>
$$
\bar{0} + \bar{1} = \bar{1},~~~ \bar{1} + \bar{1} = \bar{0}
$$

$\bar{1}$を足すことはon-off反転


## 例

<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<div id="lightsout2x2">
</div>
<script src="lightsout2x2.js"></script>

## 連立方程式 {class="left"}

>- ${\mathbf S}:$ on-offの初期状態を表すベクトル

>- ${\mathbf v}_i:$ タイル$i$を押すことによる変化を表すベクトル

>- $x_i:$ タイル$i$を押すか押さないか
$$
x_i = 
\begin{cases}
\bar{1} & 押す\\
\bar{0} & 押さない
\end{cases}
$$

>- 連立方程式:
$${\mathbf S} + x_1{\mathbf v}_1 + x_2{\mathbf v}_2 + \cdots + x_n{\mathbf v}_n=\bar{0}$$
<br/>
$${x_1{\mathbf v}_1 + x_2{\mathbf v}_2 + \cdots + x_n{\mathbf v}_n=-{\mathbf S}}$$

## 例(2x2)

<svg width="100" height="100">	<rect x="0" y="0" width="50" height="50"  fill="yellow" fill-opacity="0.5" stroke="black" />	<rect x="50" y="0" width="50" height="50" fill="yellow" fill-opacity="0.5" stroke="black" />	<rect x="0" y="50" width="50" height="50" fill="yellow" fill-opacity="0.5" stroke="black" />	<rect x="50" y="50" width="50" height="50"fill="yellow" fill-opacity="0.5" stroke="black" /> <text fill="blue" stroke="blue" x="15" y= "35">1</text> <text fill="blue" stroke="blue" x="15" y= "85">2</text> <text fill="blue" stroke="blue" x="65" y= "35">3</text> <text fill="blue" stroke="blue" x="65" y= "85">4</text></svg>

>- 
$\begin{array}{c}\color{blue}{\mathtt 1}\\\color{blue}{\mathtt 2}\\\color{blue}{\mathtt 3}\\\color{blue}{\mathtt 4}\end{array}~~x\begin{pmatrix}1\\\bar{1}\\\bar{1}\\0\end{pmatrix}+y\begin{pmatrix}\bar{1}\\\bar{1}\\\bar{0}\\\bar{1}\end{pmatrix}+z\begin{pmatrix}\bar{1}\\\bar{0}\\\bar{1}\\\bar{1}\end{pmatrix}+w\begin{pmatrix}\bar{0}\\\bar{1}\\\bar{1}\\\bar{1}\end{pmatrix}=\begin{pmatrix}\bar{1}\\\bar{1}\\\bar{1}\\\bar{1}\end{pmatrix}$
<br/>
<br/>

>-
$\left\{\begin{array}{ccccccccc}x & + & y & + & z &  &  & = & \bar{1}\\ x & + & y &  & & + & w & = & \bar{1}\\  x &  &  & + & z & + & w & = & \bar{1}\\   &  & y & + & z & + & w & = & \bar{1}\\\end{array}\right.$


## 問(2x2)

<svg width="100" height="100">	<rect x="0" y="0" width="50" height="50"  fill="yellow" fill-opacity="0.5" stroke="black" />	<rect x="50" y="0" width="50" height="50" fill="gray" fill-opacity="0.5" stroke="black" />	<rect x="0" y="50" width="50" height="50" fill="gray" fill-opacity="0.5" stroke="black" />	<rect x="50" y="50" width="50" height="50"fill="gray" fill-opacity="0.5" stroke="black" /> <text fill="blue" stroke="blue" x="15" y= "35">1</text> <text fill="blue" stroke="blue" x="15" y= "85">2</text> <text fill="blue" stroke="blue" x="65" y= "35">3</text> <text fill="blue" stroke="blue" x="65" y= "85">4</text></svg>

## いつでも解けるわけではない

<svg width="100" height="100">	<rect x="0" y="0" width="50" height="50"  fill="yellow" fill-opacity="0.5" stroke="black" />	<rect x="50" y="0" width="50" height="50" fill="gray" fill-opacity="0.5" stroke="black" />	 <text fill="blue" stroke="blue" x="15" y= "35">1</text> <text fill="blue" stroke="blue" x="65" y= "35">2</text> </svg>

>-
$\left\{\begin{array}{ccccc}x & + & y & = & \bar{1}\\ x & + & y & = & \bar{0}\end{array}\right.$

## 解けない例

<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<div id="lightsout4">
</div>
<script src="unsolvablelightsout4.js"></script>

## ラプラシアンとその階数

タイル(ライト)が$n$枚

>- $\bullet$ ベクトル$\overrightarrow{v}_i$を並べたもの
$$
L = (\overrightarrow{v}_1, \overrightarrow{v}_2, \ldots, \overrightarrow{v}_n)
$$
を**ラプラシアン**と呼ぶ。

>- $\bullet$ 
解ける初期配置の個数はある整数$r$によって$2^r$個と表される。

>- $\bullet$ 
$r$を$L$の**階数**と呼ぶ。$n-r$を**余階数**と呼ぶことにする。

>- $\bullet$ 
可解なとき、解の個数は$2^{n-r}$個ある。


## 例(４ｘ４の場合の解)

$n=4^2=16$で階数$r=12$. よって余階数$n-r=4$

解ける初期配置に対して$2^{余階数} = 16$通りの解がある。

<img src="sq4-2.png" width="100"></img> $\times 1~~$
<img src="sq4-3.png" width="100"></img> $\times 1$

<img src="sq4-1-2-4.png" width="100"></img> $\times 2$

<img src="sq4-1-2-3-4.png" width="100"></img> $\times 4~~$
<img src="sq4-1-3.png" width="100"></img> $\times 4~~$
<img src="sq4.png" width="100"></img> $\times 4$



## ラプラシアンの階数

>- コンピュータを用いた計算結果：<a href="http://oeis.org/A159257"> On-Line Encyclopedia of Integer Sequences A159257</a>

>- 階数を求める良い方法は今の所発見されていない


# 解の形状


## Sutnerの定理

>- 
K.Sutnerは1989年にどのような(グラフ上の）ライツアウトパズルも
すべてのライトが点灯している状態を初期状態とする
とき(all-one problem)、可解であることを示した。


## $n=60, 余階数=0$

<center>
<img src="square60.png" width="600"></img>
</center>

## $n=80,~ 余階数=0$

<center>
<img src="square80.png" width="600"></img>
</center>

## $n=100,~ 余階数=0$

<center>
<img src="square100.png" width="600"></img>
</center>

## $n=120,~ 余階数=0$

<center>
<img src="square120.png" width="600"></img>
</center>


## $n=140,~ 余階数=0$

<center>
<img src="square140.png" width="600"></img>
</center>


## $n=151,~ 余階数=0$

<center>
<img src="square151.png" width="600"></img>
</center>


## $n=61,~ 余階数=40$

<center>
<img src="square61.png" width="600"></img>
</center>


# 正三角形タイル張り

## 正三角形ライツアウト

一辺の長さが$n$の正三角形を一辺の長さが
$1$の正三角形$n^2$個で敷き詰める。

<center>
<img src="triangle10init.png" width="600"></img>
</center>

## 基本解

<center>
<img src="triangle10fund.png" width="600"></img>
</center>


## $n=2,~余階数=1$

<center>
<img src="triangle2.png" width="300"></img>
<img src="triangle2-1.png" width="300"></img>
</center>

## $n=3,~余階数=1$

<center>
<img src="triangle3.png" width="300"></img>
<img src="triangle3-1.png" width="300"></img>
</center>

## $n=4,~余階数=2$

<center>
<img src="triangle4.png" width="300"></img>
<img src="triangle4-1.png" width="300"></img>
<img src="triangle4-2.png" width="300"></img>
<img src="triangle4-3.png" width="300"></img>
</center>

## $n=5,~余階数=2$

<center>
<img src="triangle5.png" width="300"></img>
<img src="triangle5-1.png" width="300"></img>
<img src="triangle5-2.png" width="300"></img>
<img src="triangle5-3.png" width="300"></img>
</center>

## $n=6,~余階数=3$

<center>
<img src="triangle6.png" width="200"></img>
<img src="triangle6-1.png" width="200"></img>
<img src="triangle6-2.png" width="200"></img>
<img src="triangle6-3.png" width="200"></img>
<img src="triangle6-4.png" width="200"></img>
<img src="triangle6-5.png" width="200"></img>
<img src="triangle6-6.png" width="200"></img>
<img src="triangle6-7.png" width="200"></img>
</center>

## 予想

一辺の長さ$n$の正三角形タイル張りライツアウトについては

>- all-one problemの解は$D_3$-不変
>- $$余階数=\left\lfloor\frac{n}{2}\right\rfloor$$


## $n=100,~余階数=50$

<center>
<img src="triangle100rand.png" width="600"></img>
</center>



# ペンローズタイル張り


## ペンローズタイル張りとは

>- 準周期性
>- 5回対称性
>- 5次元空間からの2次元平面への射影

## ペンローズタイル張りの構成

$$\zeta = \exp(\pi{i}/5),~~~ \varphi =\frac{1+\sqrt{5}}{2}=\zeta + \zeta^{-1}$$

$(x_0,x_1,\cdots,x_4)\in {\mathbb Z}^5$で

$x_0 + x_1\zeta + \cdots + x_4\zeta^{4}\in{\mathbb C}$を略記

## ペンローズタイル張りの構成2

Aタイプ三角形(頂角$\pi/5$、等辺長$1$)を拡大細分する。

<center>
<img src="expsub1.png" width="800"></img>
</center>


## ペンローズタイル張りの構成3

Bタイプ三角形(頂角$3\pi/5$、等辺長$1$)を拡大細分する。

<center>
<img src="expsub2.png" width="600"></img>
</center>


## ペンローズタイル張りの構成4

<div id="penroseexp"></div>
<script src="penroseexp.js"></script>

## 是非遊んで下さい。

https://pro4-12b05.firebaseapp.com/

# all-one problemの解のかたち

## 拡大回数1 corank=0

<center>
<img src="penrose1.png" width="600"></img>
</center>

## 拡大回数2 corank=1

<center>
<img src="penrose2.png" width="600"></img>
</center>

## 拡大回数3 corank=0

<center>
<img src="penrose3.png" width="600"></img>
</center>

## 拡大回数4 corank=12

<center>
<img src="penrose4.png" width="600"></img>
</center>

## 拡大回数5 corank=10

<center>
<img src="penrose5.png" width="600"></img>
</center>

## 拡大回数6 corank=2

<center>
<img src="penrose6.png" width="600"></img>
</center>

## 拡大回数7 corank=0

<center>
<img src="penrose7.png" width="600"></img>
</center>


## 拡大回数8 corank=6

<center>
<img src="penrose8.png" width="600"></img>
</center>

## 拡大回数9 corank=6

<center>
<img src="penrose9.png" width="600"></img>
</center>

# まとめ

## 疑問

>- 正三角形ライツアウトの解はなぜ$D_3$-不変なのか？

>- ペンローズライツアウトの解の中心付近の正五角形状の塊は拡大し続ける？　
	どれぐらいの勢いで？


# ありがとうございました

##

<center>
<image src="anim.gif"></image>
</center>

## 調和関数

$$
{\rm Ker }L = \left\{{\bf x}\in {\mathbb F}_2^{n^2}\,\middle|\,L{\bf x} = {\bf 0}\right\}
$$

<center>
<img src="harm1.png" width="180"></img>
<img src="harm2.png" width="180"></img>
<img src="harm3.png" width="180"></img>
<img src="harm4.png" width="180"></img>
<img src="harm5.png" width="180"></img>
<img src="harm6.png" width="180"></img>
<img src="harm7.png" width="180"></img>
<img src="harm8.png" width="180"></img>
<img src="harm9.png" width="180"></img>
<img src="harm10.png" width="180"></img>
</center>

